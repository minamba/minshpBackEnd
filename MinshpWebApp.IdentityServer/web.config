<?xml version="1.0" encoding="utf-8"?>
<configuration>
	<location path="." inheritInChildApplications="false">
		<system.webServer>
			<!-- ASP.NET Core Module v2 -->
			<handlers>
				<add name="aspNetCore" path="*" verb="*" modules="AspNetCoreModuleV2" resourceType="Unspecified" />
			</handlers>

			<!-- Hébergement inprocess (IIS) -->
			<aspNetCore processPath="dotnet"
						arguments=".\MinshpWebApp.IdentityServer.dll"
						hostingModel="inprocess"
						stdoutLogEnabled="true"
						stdoutLogFile=".\logs\stdout"
						disableStartUpErrorPage="false">

				<environmentVariables>
					<!-- Environnement -->
					<environmentVariable name="ASPNETCORE_ENVIRONMENT" value="Production" />
					<!-- À laisser true le temps du debug, puis passer à false -->
					<environmentVariable name="ASPNETCORE_DETAILEDERRORS" value="true" />

					<!-- Chaîne de connexion : SQL sur la même machine (TCP explicite + port 1433) -->
					<environmentVariable name="ConnectionStrings__MainDb"
													 value="Data Source=.\MSSQLSERVER2019;Initial Catalog=minshpDB;User Id=minshpadmin;Password=mins19882025@;Encrypt=False;MultipleActiveResultSets=True;" />-->
					<!-- Paramètres applicatifs éventuels (adapte/complète si utiles) -->
					<environmentVariable name="Auth__Issuer" value="https://auth.minshp.com" />
					<environmentVariable name="Api__BaseUrl" value="https://minshp.com" />
					<environmentVariable name="Clients__MinshpApi__ClientId" value="minshp-api-client" />
					<environmentVariable name="Clients__MinshpApi__Secret" value="REMPLACE-MOI-par-un-secret-solide" />
				</environmentVariables>
			</aspNetCore>
		</system.webServer>
	</location>
</configuration>
